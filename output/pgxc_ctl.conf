#!/usr/bin/env bash
pgxcInstallDir=$HOME/pgxc
#---- OVERALL -----------------------------------------------
pgxcOwner=$USER
pgxcUser=$pgxcOwner
tmpDir=/tmp
localTmpDir=$tmpDir
configBackup=n
configBackupHost=pgxc-linker
configBackupDir=$HOME/pgxc
configBackupFile=pgxc_ctl.bak
dataDirRoot=$HOME/DATA/pgxl/nodes


#---- GTM -----------------------------------------------

#---- Overall -------
gtmName=(gtmmaster1)

#---- GTM Master -----------------------------------------------

#---- Overall -------
gtmMasterServer=(gtmmaster1)
gtmMasterPort=(4444)
gtmMasterDir=($pgxcInstallDir/gtmmaster1)

#---- Configuration ---
gtmExtraConfig=()
gtmMasterSpecificExtraConfig=()


#---- GTM Standby -----------------------------------------------

#---- Overall ------
gtmSlave=y
gtmSlaveName=(gtmslave1)
gtmSlaveServer=(gtmslave1)
gtmSlavePort=(4444)
gtmSlaveDir=($pgxcInstallDir/gtmslave1)

#---- Configuration ----
gtmSlaveSpecificExtraConfig=()


#---- GTM Proxy ---------------

#---- Overall ------
gtmProxy=y
gtmProxyNames=(gtmproxy1 gtmproxy2)
gtmProxyServers=(cnmaster1 cnmaster2)
gtmProxyPorts=(4445 4445)
gtmProxyDir=$pgxcInstallDir/gtmproxy
gtmProxyDirs=($gtmProxyDir $gtmProxyDir)

#---- Configuration ----
gtmPxyExtraConfig=()


#---- Coordinators -----------------------------------------------

#---- shortcuts ----------
coordMasterDir=$dataDirRoot/coord_master
coordSlaveDir=$HOME/coord_slave
coordArchLogDir=$HOME/coord_archlog

#---- Overall ------------
coordNames=(cnmaster1 cnmaster2)
coordPorts=(5555 5555)
poolerPorts=(5556 5556)
coordPgHbaEntries=(0.0.0.0/0)

#---- Master -------------
coordMasterServers=(cnmaster1 cnmaster2)
coordMasterDirs=($coordMasterDir $coordMasterDir)
coordMaxWALsender=5
coordMaxWALSenders=($coordMaxWALsender $coordMaxWALsender)


#---- Slave -------------
coordSlave=y
coordSlaveSync=y
coordUserDefinedBackupSettings=n
coordSlaveServers=(cnslave1 cnslave2)
coordSlavePorts=(5555 5555)
coordSlavePoolerPorts=(5556 5556)
coordSlaveDirs=($coordSlaveDir $coordSlaveDir)
coordArchLogDirs=($coordArchLogDir $coordArchLogDir)


#---- Configuration files---
coordExtraConfig=coordExtraConfig
cat > $coordExtraConfig <<EOF
log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
listen_addresses = '*'
max_connections = 100
hot_standby = off
EOF
coordSpecificExtraConfig=()
coordSpecificExtraPgHba=()


#---- Datanodes -----------------------------------------------

#---- Shortcuts --------------
datanodeMasterDir=$dataDirRoot/dn_master
datanodeSlaveDir=$dataDirRoot/dn_slave
datanodeArchLogDir=$dataDirRoot/datanode_archlog


#---- Overall ---------------
primaryDatanode=dn1
datanodeNames=(dnmaster1 dnmaster2 dnmaster3)
datanodePorts=(6666 6666 6666)
datanodePoolerPorts=(6667 6667 6667)
datanodePgHbaEntries=(0.0.0.0/0)


#---- Master ----------------
datanodeMasterServers=(dnmaster1 dnmaster2 dnmaster3)
datanodeMasterDirs=($datanodeMasterDir $datanodeMasterDir $datanodeMasterDir)
datanodeMaxWalSender=5
datanodeMaxWALSenders=($datanodeMaxWalSender $datanodeMaxWalSender $datanodeMaxWalSender)


#---- Slave -------------
datanodeSlave=y
datanodeSlaveSync=y
datanodeUserDefinedBackupSettings=n
datanodeSlaveServers=(dnslave1 dnslave2 dnslave3)
datanodeSlavePorts=(6666 6666 6666)
datanodeSlavePoolerPorts=(6667 6667 6667)
datanodeSlaveDirs=($datanodeSlaveDir $datanodeSlaveDir $datanodeSlaveDir)
datanodeArchLogDirs=($datanodeArchLogDir $datanodeArchLogDir $datanodeArchLogDir)
# ---- Configuration files ---
datanodeExtraConfig=datanodeExtraConfig	
cat > $datanodeExtraConfig <<EOF
log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
listen_addresses = '*'
max_connections = 100
hot_standby = off
EOF
datanodeSpecificExtraConfig=()
datanodeSpecificExtraPgHba=()